<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;55.&nbsp;Server to Server Protocol Settings</title><link rel="stylesheet" type="text/css" href="css/docbook-xsl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Tigase Administration Guide"><link rel="up" href="index.html" title="Tigase Administration Guide"><link rel="prev" href="_configuration_sasl_external.html" title="Chapter&nbsp;54.&nbsp;Configuration SASL EXTERNAL"><link rel="next" href="_connection_throughput.html" title="Connection Throughput"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;55.&nbsp;Server to Server Protocol Settings</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="_configuration_sasl_external.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="_connection_throughput.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="_server_to_server_protocol_settings"></a>Chapter&nbsp;55.&nbsp;Server to Server Protocol Settings</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="_server_to_server_protocol_settings.html#_number_of_concurrent_connections">Number of Concurrent Connections</a></span></dt><dt><span class="section"><a href="_connection_throughput.html">Connection Throughput</a></span></dt><dt><span class="section"><a href="_maximum_packet_waiting_time_and_connection_inactivity_time.html">Maximum Packet Waiting Time and Connection Inactivity Time</a></span></dt><dt><span class="section"><a href="_custom_plugin_selecting_s2s_connection.html">Custom Plugin Selecting s2s Connection</a></span></dt></dl></div><p>Artur Hefczyc &lt;<a class="link" href="mailto:artur.hefczyc@tigase.net" target="_top">artur.hefczyc@tigase.net</a>&gt;
v2.0, June 2014: Reformatted for AsciiDoc.
:toc:
:numbered:
:website: <a class="link" href="http://tigase.net" target="_top">http://tigase.net</a>
:Date: 2010-06-29 21:27</p><p>The Tigase server <span class="strong"><strong>5.1.0</strong></span> or later offers new, rewritten from scratch implementation for s2s communication which allows you to tweak it&#8217;s configuration to get a better performance in your installation.</p><p>S2S (or server to server) protocol is enabled by default with setting which are optimal for the most common cases. There is however a set of configuration parameters you can adjust the server behaviour to get an optimal performance for your installation.</p><p>This documents describes following elements of the Tigase server configuration:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">Number of concurrent connections to external servers</li><li class="listitem">The connection throughput parameters</li><li class="listitem">Maximum waiting time for packets addressed to external servers and the connection inactivity time</li><li class="listitem">Custom plugins selecting connection to the remote server</li></ol></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_number_of_concurrent_connections"></a>Number of Concurrent Connections</h2></div></div></div><p>Normally only one connection to the remote server is required to send XMPP stanza to that server. In some cases however, under a high load, you can get much better throughput and performance if you open multiple connections to the remote server.</p><p>This is especially true when the remote server works in a cluster mode. Ideally you want to open a connection to each of the cluster nodes on the remote server. This way you can spread the traffic evenly among cluster nodes and improve the performance for s2s connections.</p><p>The Tigase server offers 2 different parameters to tweak the number of concurrent, s2s connections:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p class="simpara">'max-out-total-conns' - the property specifies the maximum outgoing connections the Tigase server opens to any remote XMPP server. This is 'per domain' limit, which means that this limit applies to each of the remote domain the Tigase connects to. If it is set to '4' then Tigase opens maximum 4 connections to 'jabber.org' plus maximum 4 connections to 'muc.jabber.org' even if this is the same physical server behind the same IP address.</p><p class="simpara">To adjust the limit you have to add following line to the init.properties file:</p><pre class="programlisting">s2s/max-out-total-conns[I]=2</pre></li><li class="listitem"><p class="simpara">'max-out-per-ip-conns' - the property specifies the maximum outgoing connections the Tigase server opens to any remote XMPP server to its single IP address. This is 'per domain' limit, which means that this limit applies to each of the remote domain the Tigase connects to. If it is set to '1', above limit is set to '4' and the remote server is visible behind 1 IP address then Tigase opens maximum 1 connection to 'jabber.org' plus maximum 1 connection to 'muc.jabber.org', etc&#8230;&#8203;.</p><p class="simpara">To adjust the limit you have to add following line to the init.properties file:</p><pre class="programlisting">s2s/max-out-per-ip-conns[I]=2</pre></li></ul></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="_configuration_sasl_external.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="_connection_throughput.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;54.&nbsp;Configuration SASL EXTERNAL&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Connection Throughput</td></tr></table></div></body></html>