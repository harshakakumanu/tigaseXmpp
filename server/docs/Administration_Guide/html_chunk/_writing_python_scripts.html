<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Writing Python Scripts</title><link rel="stylesheet" type="text/css" href="css/docbook-xsl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Tigase Administration Guide"><link rel="up" href="_tigase_and_python.html" title="Chapter&nbsp;4.&nbsp;Tigase and Python"><link rel="prev" href="_tigase_and_python.html" title="Chapter&nbsp;4.&nbsp;Tigase and Python"><link rel="next" href="_about_tigase_jabber_xmpp_server.html" title="Chapter&nbsp;5.&nbsp;About Tigase Jabber/XMPP Server"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Writing Python Scripts</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="_tigase_and_python.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;4.&nbsp;Tigase and Python</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="_about_tigase_jabber_xmpp_server.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_writing_python_scripts"></a>Writing Python Scripts</h2></div></div></div><p>Python scripts work, generally in a similar way to Groovy or other languages scripts, except one significant difference. You cannot call "<span class="emphasis"><em>return</em></span>" from the script itself. Hence you cannot simply pass script results by calling "<span class="emphasis"><em>return</em></span>" statement directly from the script.</p><p>To overcome the  problem Tigase offers another way to pass script execution results. It checks the value of a special variables on the script completion: "result" and "packet". By assigning value to one of these variables the Python (or any other language) can pass execution results back to the Tigase server.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">"result" allows to return simple text (or characters String) from the script.</li><li class="listitem">"packet" allows to return Packet instance which is send back to the user.</li></ul></div><p>The simplest possible Python script may look like this one:</p><p>result = "Hello world!"</p><p>For instructions how to load and execute the script, please refer to ////&lt;&lt;introductoryArticle,////introductory article for scripting in the Tigase server. There were some minor changes in later the Tigase 4.4.0 and later version, so please have a look at the ////&lt;&lt;newElements,////article describing new elements as well.</p><p>A bit more advanced script asks the user for providing required parameters for the actual script execution:</p><pre class="programlisting">from java.lang import *
from tigase.server import *

num1 = Command.getFieldValue(packet, "num1")
num2 = Command.getFieldValue(packet, "num2")

if num1 is None or num2 is None:
  res = Iq.commandResultForm(packet)
  Command.addTextField(res, "Note", "This is a Python script!")
  Command.addFieldValue(res, "num1", "")
  Command.addFieldValue(res, "num2", "")
  packet = res
else:
  result = num1 + num2</pre><p>Except this rather minor difference, the rest part of scripting in Python for the Tigase administrator commands is the same as for all other languages. As all languages can return execution results via these special variables, it could be argued there is no difference at all.</p><p>In next articles, I am going to present the Tigase server API available for scripting framework. My main language is Groovy as it offers the best integration with JVM and Tigase API, however I will try to include Python example code as well.</p><p>_I hope this article encourages you to try the scripting support in the Tigase server. If you have any suggestions or questions please do not hesitate to send me your comments. I have also created a new <a class="link" href="http://www.tigase.org/forums/tigase-scripts" target="_top">tigase scripts</a> forum on the website. If you have an interesting script to share or want to discuss some aspects of this functionality do not hesitate to add your post.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><a class="link" href="files/jython-2.5.1.jar" target="_top">jython-2.5.1.jar</a> 6.44 MB</li></ul></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="_tigase_and_python.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="_tigase_and_python.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="_about_tigase_jabber_xmpp_server.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;4.&nbsp;Tigase and Python&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;5.&nbsp;About Tigase Jabber/XMPP Server</td></tr></table></div></body></html>