<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;36.&nbsp;StanzaSender</title><link rel="stylesheet" type="text/css" href="css/docbook-xsl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Tigase Administration Guide"><link rel="up" href="index.html" title="Tigase Administration Guide"><link rel="prev" href="_configuration_options.html" title="Configuration Options"><link rel="next" href="_configuration_2.html" title="Configuration"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;36.&nbsp;StanzaSender</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="_configuration_options.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="_configuration_2.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="_stanzasender"></a>Chapter&nbsp;36.&nbsp;StanzaSender</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="_stanzasender.html#_how_it_works">How it Works</a></span></dt><dd><dl><dt><span class="section"><a href="_stanzasender.html#_filetask">FileTask</a></span></dt><dt><span class="section"><a href="_stanzasender.html#_jdbctask">JDBCTask</a></span></dt></dl></dd><dt><span class="section"><a href="_configuration_2.html">Configuration</a></span></dt></dl></div><p>Artur Hefczyc &lt;<a class="link" href="mailto:artur.hefczyc@tigase.net" target="_top">artur.hefczyc@tigase.net</a>&gt;
v2.0, June 2014: Reformatted for AsciiDoc.
:toc:
:numbered:
:website: <a class="link" href="http://tigase.net" target="_top">http://tigase.net</a>
:Date: 2010-04-06 21:18</p><p>This is a component which make it easier to integrate Jabber/XMPP server with other, third-party tools.</p><p>It simply allows you to send stanzas from your application without implementing any Jabber/XMPP specific code. The component regularly reads specified data source for XMPP packets to send. The data source can be an SQL database, directory on your filesystem or anything you might want.</p><p>If you have Web application for example which you want to send notifications of any event to selected users you can install <a class="link" href="http://server.tigase.org/browser/trunk/src/main/java/tigase/server/ssender/StanzaSender.java" target="_top">StanzaSender</a> component on your Tigase server. It will help you to easily distribute your messages to end-users.</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_how_it_works"></a>How it Works</h2></div></div></div><p>The module itself doesn&#8217;t do anything. It just schedules tasks and sends stanzas which come from&#8230;&#8203; it doesn&#8217;t know. To do actual work of retrieving stanzas from data source the component uses <span class="strong"><strong>tasks</strong></span>.</p><p>In theory the task can retrieve XMPP packets for sending from any location or may just generate stanzas on its own.</p><p>In practise there are 2 <span class="strong"><strong>tasks</strong></span> already implemented and ready to use. You can treat them as a sample code for implementation of your own tasks customised for your specific needs or you can just use these tasks as they are.</p><p>The tasks which are available are:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">FileTask retrieving stanzas from directory in file system.</li><li class="listitem">JDBCTask retrieving stanzas from SQL database.</li></ul></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_filetask"></a>FileTask</h3></div></div></div><p>FileTask implements tasks for cyclic retrieving stanzas from a directory and sending them to the StanzaHandler object.</p><p>It looks for any new stanza to send. Any single file can contain only single stanza to send and any entry in database table can also contain only single stanza to send. File on hard disk and record in database is deleted after it is read.</p><p>Any file in given directory is treated the same way - Tigase assumes it contains valid XML data with XMPP stanza to send. You can however set in configuration, using wildchars which files contain stanzas. All stanzas must contain complete data including correct "<span class="emphasis"><em>from</em></span>" and "<span class="emphasis"><em>to</em></span>" attributes.</p><p>By default it looks for *.stanza files in /var/spool/jabber/ folder but you can specify different directory name in initialization string. Sample initialization strings:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">/var/spool/jabber/*.stanza</li><li class="listitem">/var/spool/jabber/*</li></ul></div><p>The last is equal to:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">/var/spool/jabber/</li></ul></div><p>Note the last forward slash '/' is required in such case if the last element of the path is a directory.</p><p><span class="strong"><strong>Please note! Tigase must have writing permissions for this directory, otherwise it may not function properly.</strong></span></p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_jdbctask"></a>JDBCTask</h3></div></div></div><p>JDBCTask implements tasks for cyclic retrieving stanzas from database and sending them to the StanzaHandler object.</p><p>Database table format:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><span class="strong"><strong>id</strong></span> - numerical unique record indetifier.</li><li class="listitem"><span class="strong"><strong>stanza</strong></span> - text field containing valid XML data with XMPP stanza to send.</li></ul></div><p>Any record in this table is treated the same way - Tigase assmes it contains valid XML data with XMPP stanza to send. No other data are allowed in this table. All stanzas must be complete including correct "<span class="emphasis"><em>from</em></span>" and "<span class="emphasis"><em>to</em></span>" attriutes.</p><p>By default it looks for stanzas in xmpp_stanza table but you can specify different table name in connection string. Sample connection string:</p><p>jdbc:mysql://localhost/tigasedb?user=tigase&amp;password=pass&amp;table=xmpp_stanza</p><p>Please note the last parameter which is specific to JDBCTask. You can specify the table name which stores stanzas for sending. If omitted default value is: xmpp_stanza.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="_configuration_options.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="_configuration_2.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Configuration Options&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Configuration</td></tr></table></div></body></html>