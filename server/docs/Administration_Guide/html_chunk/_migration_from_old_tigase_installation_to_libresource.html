<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Migration From old Tigase Installation to LibreSource</title><link rel="stylesheet" type="text/css" href="css/docbook-xsl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Tigase Administration Guide"><link rel="up" href="_integrating_tigase_server_with_libresource.html" title="Chapter&nbsp;75.&nbsp;Integrating Tigase Server With LibreSource"><link rel="prev" href="_how_to_set_tigase_up.html" title="How to set Tigase up."><link rel="next" href="_windows_installation.html" title="Chapter&nbsp;76.&nbsp;Windows Installation"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Migration From old Tigase Installation to LibreSource</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="_how_to_set_tigase_up.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;75.&nbsp;Integrating Tigase Server With LibreSource</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="_windows_installation.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_migration_from_old_tigase_installation_to_libresource"></a>Migration From old Tigase Installation to LibreSource</h2></div></div></div><p>Tigase package includes additional tools to make it easier to manage and control you installation. One is used to change configuration settings - config.sh and another is used to manipulate user data in repository - repo.sh.</p><p>Depending on whether you use Tigase version built from sources or binary version these scripts might be available in either scripts/ or bin/ subdirectory. To make things simpler let&#8217;s assume they are stored in scripts/ directory.</p><p>Assuming you have old Tigase server installation with number of users in MySQL database and you want to migrate all of them to LibreSource there are 2 steps involved:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">User data migration</li><li class="listitem">Changing your existing configuration</li></ol></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_data_migration"></a>Data Migration</h3></div></div></div><p>First we need to migrate user data used for authentication. That data will be used by both services: <span class="emphasis"><em>LibreSource</em></span> and <span class="emphasis"><em>Tigase</em></span> and they normally stored in <span class="emphasis"><em>LibreSource</em></span> database. Therefore we have to use <span class="emphasis"><em>LibreSource</em></span> database connector to handle the data (write or read). <span class="emphasis"><em>Tigase</em></span> server will be using <span class="emphasis"><em>LibreSource</em></span> database for reading only but during migration time we need to write user accounts to LS database. Sample command to migrate user accounts looks like this:</p><pre class="programlisting">./scripts/repo.sh -sc tigase.db.jdbc.JDBCRepository \
  -su "jdbc:mysql://localhost/tigase?user=dbuser&amp;password=dbpass" \
  -dc tigase.db.jdbc.LibreSourceAuth \
  -du "jdbc:postgresql://localhost/libresource?user=demo" \
  -cp</pre><p>Above command will copy all user accounts from MySQL tigase database to libresource database. Please refer to repository management tool documentation for information how to migrate single or selected user accounts.</p><p>If you want to also keep all Tigase server data in the same database you have to copy also all other user data like rosters, vCards and so on.</p><p>First thing to do we have to load database schema for Tigase data. You don&#8217;t have to worry. Tigase tables have distinct names from LibreSource so there is no danger for any conflict. As in example above let&#8217;s assume LibreSource data are stored in libresource database and database user name is demo:</p><pre class="programlisting">psql -q -U demo -d libresource -f database/postgresql-schema.sql</pre><p>Now we can load transfer all user data from our MySQL database to LibreSource:</p><pre class="programlisting">./scripts/repo.sh -sc tigase.db.jdbc.JDBCRepository \
  -su "jdbc:mysql://localhost/tigase?user=dbuser&amp;password=dbpass" \
  -dc tigase.db.jdbc.JDBCRepository \
  -du "jdbc:postgresql://localhost/libresource?user=demo" \
  -cp</pre><p>This command looks almost the same as a previous one. Just Java class used for handling destination database is different.</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="_how_to_set_tigase_up.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="_integrating_tigase_server_with_libresource.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="_windows_installation.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">How to set Tigase up.&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;76.&nbsp;Windows Installation</td></tr></table></div></body></html>