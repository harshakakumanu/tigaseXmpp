<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Retrieving statistics from the server</title><link rel="stylesheet" type="text/css" href="css/docbook-xsl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Tigase Administration Guide"><link rel="up" href="_server_monitoring.html" title="Chapter&nbsp;44.&nbsp;Server Monitoring"><link rel="prev" href="_server_monitoring.html" title="Chapter&nbsp;44.&nbsp;Server Monitoring"><link rel="next" href="TipsAndTricks.html" title="Chapter&nbsp;45.&nbsp;Tips and Tricks"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Retrieving statistics from the server</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="_server_monitoring.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;44.&nbsp;Server Monitoring</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="TipsAndTricks.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="RetrievingStatisticsFromTheServer"></a>Retrieving statistics from the server</h2></div></div></div><p>By default we can retrieve server statistics using XMPP. After a successful setup of <a class="xref" href="_server_monitoring.html#setUpRemoteMonitoring" title="Setting Up Remote Monitoring in the Server">the section called &#8220;Setting Up Remote Monitoring in the Server&#8221;</a> we can enable additional@@, configured methods (JMX, HTTP, etc).</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_retrieving_statistics_using_xmpp"></a>Retrieving statistics using XMPP</h3></div></div></div><p>Accessing statistics over XMPP protocol requires any XMPP client capable of executing <a class="link" href="http://xmpp.org/extensions/xep-0050.html" target="_top">XEP-0050: Ad-Hoc Commands</a>. It&#8217;s essential to remember, that only administrator (a user whose JID is configured as administrative) can access the statistics.</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_psi_xmpp_client"></a>Psi XMPP Client</h4></div></div></div><p>For the purpose of this guide a <a class="link" href="http://psi-im.org/" target="_top">Psi</a> client will be used. After successfully configuring and connecting to account with administrative privileges we need to access <span class="emphasis"><em>Service Discovery</em></span>, either from application menu or from context menu of the particular account account:</p><div class="figure"><a name="d0e5077"></a><p class="title"><b>Figure&nbsp;44.1.&nbsp;Access service discovery</b></p><div class="figure-contents"><div class="mediaobject"><img src="./images/monitoring_xmpp_1.png" width="233" alt="roster-discovery"></div></div></div><br class="figure-break"><p>In the <span class="emphasis"><em>Service Discovery</em></span> window we need to find <span class="emphasis"><em>Server Statistics</em></span> component:</p><div class="figure"><a name="d0e5094"></a><p class="title"><b>Figure&nbsp;44.2.&nbsp;Access statistics component in service discovery</b></p><div class="figure-contents"><div class="mediaobject"><img src="./images/monitoring_xmpp_2.png" width="558" alt="discovery-stats"></div></div></div><br class="figure-break"><p>We can either access statistics for all components or select particular component after expanding the tree. To execute ad-hoc command simply double click on the particular node which will open window with statistics:</p><div class="figure"><a name="d0e5105"></a><p class="title"><b>Figure&nbsp;44.3.&nbsp;Server statistics</b></p><div class="figure-contents"><div class="mediaobject"><img src="./images/monitoring_xmpp_3.png" width="456" alt="server-stats"></div></div></div><br class="figure-break"><p>In this window, in addition to see the statistics, we can adjust <span class="emphasis"><em>Stats level</em></span> by selecting desired level from the list and confiming by presing <span class="emphasis"><em>Finish</em></span>.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_retrieving_statistics_using_jmx"></a>Retrieving statistics using JMX</h3></div></div></div><p>In order to access statistics over JMX we need to enable support for it in Tigase - <a class="xref" href="_server_monitoring.html#monitoring_activation" title="Activation">the section called &#8220;Activation&#8221;</a>. Afterwards we can use a number of tools, for example following:</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_jconsole"></a>JConsole</h4></div></div></div><p>After opening JConsole we either select local process or provide details of the remote process, including IP, port and credentials from <span class="strong"><strong>etc/jmx.</strong></span>* files:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/monitoring_jmx_jconsole_1.png" width="754" alt="jconsole"></div></div><p>Afterwards we navigate to MBeans tab from where we can access <code class="literal">tigase.stats</code> MBean. It offers similar options to XMPP - either accessing statistics for all components or only for particular component as well as adjusting level for which we want to obtain statistics:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/monitoring_jmx_jconsole_2.png" width="967" alt="jconsole"></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="_statsdumper_groovy"></a>StatsDumper.groovy</h4></div></div></div><p>In order to collect statistics over period of time following groovy script can be used: <a class="link" href="files/StatsDumper.groovy" target="_top">StatsDumper.groovy</a>. It&#8217;s a Simple JMX client that connects to Tigase and periodically save all statistics to files.</p><p>It takes following parameters:</p><pre class="programlisting">$ groovy StatsDumper.groovy [hostname] [username] [password] [dir] [port] [delay(ms)] [interval(ms)] [loadhistory(bool)]</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">hostname - address of the instance</li><li class="listitem">username - JMX username</li><li class="listitem">password - JMX username</li><li class="listitem">dir - directory to which save the files with statistics</li><li class="listitem">port - port on which to make the connection</li><li class="listitem">delay(ms) - initial delay in milliseconds after which statistics should be saved</li><li class="listitem">interval(ms) - interval between each retrieval/saving of statistics</li><li class="listitem">loadhistory(bool) - indicates whether or not load statistics history from server (if such is enabled in Tigase)</li></ul></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="_server_monitoring.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="_server_monitoring.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="TipsAndTricks.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;44.&nbsp;Server Monitoring&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;45.&nbsp;Tips and Tricks</td></tr></table></div></body></html>