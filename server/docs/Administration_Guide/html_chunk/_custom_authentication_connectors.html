<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;68.&nbsp;Custom Authentication Connectors</title><link rel="stylesheet" type="text/css" href="css/docbook-xsl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Tigase Administration Guide"><link rel="up" href="index.html" title="Tigase Administration Guide"><link rel="prev" href="_configuring_the_tigase_server_to_load_a_component.html" title="Chapter&nbsp;67.&nbsp;Configuring the Tigase Server to Load a Component"><link rel="next" href="_tigase_custom_auth_connector.html" title="Chapter&nbsp;69.&nbsp;Tigase Custom Auth Connector"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;68.&nbsp;Custom Authentication Connectors</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="_configuring_the_tigase_server_to_load_a_component.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="_tigase_custom_auth_connector.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="_custom_authentication_connectors"></a>Chapter&nbsp;68.&nbsp;Custom Authentication Connectors</h1></div></div></div><p>Artur Hefczyc &lt;<a class="link" href="mailto:artur.hefczyc@tigase.net" target="_top">artur.hefczyc@tigase.net</a>&gt;
v2.0, June 2014: Reformatted for AsciiDoc.
:toc:
:numbered:
:website: <a class="link" href="http://tigase.net" target="_top">http://tigase.net</a>
:Date: 2010-04-06 21:18</p><p>Tigase server offers you quite a few authentication connectors which allow you to connect to almost any SQL database for user authentication data and share user accounts between the XMPP server and any different system. This feature makes it possible to integrate the Tigase server with other systems without any development effort and without any coding.</p><p>This article presents configuration options available to the administrator and describe how to set the Tigase server up to use user accounts data from a different database.</p><p>The first thing to know is that the Tigase server always opens 2 separate connections to the database. One connection is for user login data and another is for all other user data like the user roster, vCard, private data storage, privacy lists and so on&#8230;&#8203;</p><p>In this article we still assume that the Tigase server keeps user data in it&#8217;s own database and only login data are retrieved from the external database.</p><p>At the moment the Tigase server offers following authentication connectors:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">'mysql', 'pgsql', 'derby' - standard authentication connector used to load user login data from the main user database used by the Tigase server. In fact the same physical implementation is used for all JDBC databases.</li><li class="listitem">'drupal' - is the authentication connector used to integrate the Tigase server with <a class="link" href="http://drupal.org/" target="_top">Drupal CMS</a>.</li><li class="listitem">'libresource' - is the authentication connector used to integrate the Tigase server with <a class="link" href="http://dev.libresource.org/" target="_top">Libresource Collaboration platform</a>.</li><li class="listitem">'tigase-auth' - is the authentication connector which can be used with any database. It executes stored procedures to perform all actions. Therefore it is a very convenient way to integrate the server with an external database if you don&#8217;t want to expose the database structure. You just have to provide a set of stored procedures in the database. While implementing all stored procedures expected by the server might be a bit of work it allows you to hide the database structure and change the SP implementation at any time. You can add more actions on user login/logout without restarting or touching the server. And the configuration on the server side is very simple. For detailed description of this implementation please refer to ////&lt;&lt;tigaseAuthConnector,////Tigase Auth documentation.</li><li class="listitem">'tigase-custom' - is the authentication connector which can be used with any database. Unlike the 'tigase-auth' connector it allows you to define SQL queries in the configuration file. The advantage of this implementation is that you don&#8217;t have to touch your database. You can use either simple plain SQL queries or stored procedures. The configuration is more difficult as you have to enter carefully all SQL queries in the config file and changing the query usually involves restarting the server. For more details about this implementation and all configuration parameters please refer to ////&lt;&lt;custonAuthConnector,////Tigase Custom Auth documentation.</li></ul></div><p>As always the simplest way to configure the server is through the ////&lt;&lt;initPropertiesGuide,////init.properties file. In the article describing this file you can find long list with all available options and all details how to handle it. For the authentication connector setup however we only need 2 options:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">'--auth-db = connector'</li><li class="listitem">'--auth-db-uri = database connection url'</li></ul></div><p>If you happen to keep the user data in the same database as user authentication data you can even skip the second parameter as Tigase automatically assumes settings from the '--user-db-uri' it '--auth-db-uri' is missing.</p><p>'--auth-db-uri' stored a standard JDBC connection URL and is exactly the same as for all other settings. For example if you store authentication data in the 'drupal' database on 'localhost' the URL might look like:</p><pre class="programlisting">--auth-db-uri = jdbc:mysql://localhost/drupal?user=user&amp;password=passwd</pre><p>'--auth-db' stored just a connector name or connector implementation class. For convenience the Tigase has predefined short names for the most common connectors but you can always use the class name if you know it. And you have to use a class name if you want to attach your own authentication connector. The following 2 settings are equal:</p><pre class="programlisting">--auth-db = tigase-auth</pre><pre class="programlisting">--auth-db = tigase.db.jdbc.TigaseAuth</pre><p>In the same exact way you can setup connector for any different database type:</p><pre class="programlisting">--auth-db = drupal</pre><pre class="programlisting">--auth-db = tigase-custom</pre><p>You can normally skip configuring connectors for the default Tigase database format: 'mysql', 'pgsql' and 'derby' as they are applied automatically if the parameter is missing.</p><p>One more important thing to know is that you also have to modify '--user-db-uri' if you use a custom authentication connector. This is because if you retrieve user login data from the external database this external database is usually managed by external system. User accounts are added without notifying the Tigase server. Then, when the user logins and tries to retrieve the user roster the server can not find such a user in the roster database.</p><p>To keep user accounts in sync between authentication database and the main user database you have to add following option to the end of the database connection URL: 'autoCreateUser=true'.</p><p>For example:</p><pre class="programlisting">--user-db-uri=jdbc:mysql://localhost/tigasedb?user=nobody&amp;password=pass&amp;autoCreateUser=true</pre><p>If you are interested in even further customize you authentication connector by writing your own queries or stored procedures please have a look at 2 following guides:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">////&lt;&lt;tigaseAuthConnector,////Tigase Auth guide</li><li class="listitem">////&lt;&lt;custonAuthConnector,////Tigase Custom Auth guide</li></ul></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="_configuring_the_tigase_server_to_load_a_component.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="_tigase_custom_auth_connector.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;67.&nbsp;Configuring the Tigase Server to Load a Component&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;69.&nbsp;Tigase Custom Auth Connector</td></tr></table></div></body></html>