<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;49.&nbsp;MySQL Database Schema Upgrade for Tigase 5.1</title><link rel="stylesheet" type="text/css" href="css/docbook-xsl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Tigase Administration Guide"><link rel="up" href="index.html" title="Tigase Administration Guide"><link rel="prev" href="_derby_database_schema_upgrade_for_tigase_5_1.html" title="Chapter&nbsp;48.&nbsp;Derby Database Schema Upgrade for Tigase 5.1"><link rel="next" href="_postgresql_database_schema_upgrade_for_tigase_5_1.html" title="Chapter&nbsp;50.&nbsp;PostgreSQL Database Schema Upgrade for Tigase 5.1"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;49.&nbsp;MySQL Database Schema Upgrade for Tigase 5.1</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="_derby_database_schema_upgrade_for_tigase_5_1.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="_postgresql_database_schema_upgrade_for_tigase_5_1.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="_mysql_database_schema_upgrade_for_tigase_5_1"></a>Chapter&nbsp;49.&nbsp;MySQL Database Schema Upgrade for Tigase 5.1</h1></div></div></div><p>Artur Hefczyc &lt;<a class="link" href="mailto:artur.hefczyc@tigase.net" target="_top">artur.hefczyc@tigase.net</a>&gt;
v2.0, June 2014: Reformatted for AsciiDoc.
:toc:
:numbered:
:website: <a class="link" href="http://tigase.net" target="_top">http://tigase.net</a>
:Date: 2012-04-21 03:58</p><p>Unfortunately we had to make a small change to the database schema for 5.1.0 version of the Tigase server.</p><p>The good news it does not affect data or data structure, only the way some data is accessed in database. We added one more stored procedure which has to be installed in database if you upgrade your installation from a previous Tigase version.</p><p>Therefore the schema upgrade is very simple and safe but make sure the current database schema is in version 4.0. If you happen to use ancient version of the Tigase before number 4.0 and you want to upgrade to 5.1 you have to run ////&lt;&lt;40schemaUpgrade,////4.0 upgrade script first.</p><p>Assumptions:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><span class="strong"><strong>tigasedb</strong></span> is a database name</li><li class="listitem"><span class="strong"><strong>tigase_user</strong></span> is a database user name</li><li class="listitem"><span class="strong"><strong>mypass</strong></span> is database user password</li></ol></div><p>First things first - make a database backup:</p><pre class="programlisting">mysqldump -u tigase_user -pmypass tigasedb &gt; tigasedb_dump.sql</pre><p>If you need to restore database for any reason execute following commands:</p><pre class="programlisting">msyqladmin -u tigase_user -pmypass drop tigasedb
mysqladmin -u tigase_user -pmypass create tigasedb
mysql -u tigase_user -pmypass tigasedb &lt; tigasedb_dump.sql</pre><p><span class="emphasis"><em>Note! You may be required to use root user and his password to execute mysqladmin commands.</em></span></p><p>Now we can run schema upgrade script</p><pre class="programlisting">mysql -u tigase_user -pmypass tigasedb &lt; database/mysql-schema-upgrade-to-5-1.sql</pre></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="_derby_database_schema_upgrade_for_tigase_5_1.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="_postgresql_database_schema_upgrade_for_tigase_5_1.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;48.&nbsp;Derby Database Schema Upgrade for Tigase 5.1&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;50.&nbsp;PostgreSQL Database Schema Upgrade for Tigase 5.1</td></tr></table></div></body></html>