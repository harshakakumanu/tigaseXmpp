<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Custom Mechanisms Development</title><link rel="stylesheet" type="text/css" href="css/docbook-xsl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Tigase Development Guide"><link rel="up" href="saslcmac.html" title="Chapter&nbsp;15.&nbsp;SASL Custom Mechanisms and Configuration"><link rel="prev" href="_logging_authentication.html" title="Logging/Authentication"><link rel="next" href="How_Packets_are_Processed_by_the_SM_and_Plugins.html" title="Chapter&nbsp;16.&nbsp;How Packets are Processed by the SM and Plugins"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Custom Mechanisms Development</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="_logging_authentication.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;15.&nbsp;SASL Custom Mechanisms and Configuration</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="How_Packets_are_Processed_by_the_SM_and_Plugins.html">Next</a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="cmd"></a>Custom Mechanisms Development</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="__emphasis_role_strong_mechanism_emphasis"></a><span class="strong"><strong>Mechanism</strong></span></h3></div></div></div><p><code class="literal">'getAuthorizationID()\'</code> method from <code class="literal">'SaslServer'</code> class <span class="strong"><strong>should</strong></span> return bare JID authorized user. In case that the method returns only user name such as <span class="strong"><strong>romeo</strong></span> for example, the server automatically appends domain name to generate a valid BareJID: <span class="emphasis"><em>romeo@example.com</em></span>. In case the method returns a full, valid BareJID, the server does not change anything.</p><p><code class="literal">'handleLogin()\'</code> method from <code class="literal">'SessionManagerHandler'</code> will be called with user&#8217;s Bare JID provided by <code class="literal">getAuthorizationID()</code> (or created later using stream domain name).</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="__emphasis_role_strong_callbackhandler_emphasis"></a><span class="strong"><strong>CallbackHandler</strong></span></h3></div></div></div><p>For each session authorization, the server creates a new and separate, empty handler. Factory which creates handler instance allows to inject different objects to the handler, depending on interfaces implemented by the handler class:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><code class="literal">AuthRepositoryAware</code> - injects <code class="literal">AuthRepository;</code></li><li class="listitem"><code class="literal">DomainAware</code> - injects domain name within which the user attempts to authenticate</li><li class="listitem"><code class="literal">NonAuthUserRepositoryAware</code> - injects <code class="literal">NonAuthUserRepository</code>, although I have no idea what for&#8230;&#8203;</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_general_remarks"></a>General Remarks</h3></div></div></div><p><code class="literal">JabberIqAuth</code> used for non-SASL authentication mechanisms uses the same callback as the SASL mechanisms.</p><p>Methods <code class="literal">'auth'</code> in <code class="literal">'Repository'</code> interfaces will be deprecated. These interfaces will be treated as user details providers only. There will be new methods available which will allow for additional login operations on the database such as last successful login recording and so on&#8230;&#8203;</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="_known_problems"></a>Known Problems</h3></div></div></div><p>Because <code class="literal">JabberIqAuth</code> is initialized separatelly, we strongly recommend to use more general prefix in <span class="strong"><strong><code class="literal">init.properties</code></strong></span>:</p><pre class="programlisting">sess-man/plugins-conf/${KEY}=${VALUE}</pre><p>instead of</p><pre class="programlisting">sess-man/plugins-conf/urn\:ietf\:params\:xml\:ns\:xmpp-sasl/${KEY}=${VALUE}</pre><p>If <code class="literal">JabberIqAuth</code> is disabled, then you don&#8217;t care about it.</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="_logging_authentication.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="saslcmac.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="How_Packets_are_Processed_by_the_SM_and_Plugins.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Logging/Authentication&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;16.&nbsp;How Packets are Processed by the SM and Plugins</td></tr></table></div></body></html>