<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;27.&nbsp;Component Implementation - Lesson 8 - Startup Time</title><link rel="stylesheet" type="text/css" href="css/docbook-xsl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Tigase Development Guide"><link rel="up" href="index.html" title="Tigase Development Guide"><link rel="prev" href="_configuration.html" title="Configuration"><link rel="next" href="cil7.html" title="Chapter&nbsp;28.&nbsp;Component Implementation - Lesson 7 - Data Repository"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;27.&nbsp;Component Implementation - Lesson 8 - Startup Time</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="_configuration.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="cil7.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="cil8"></a>Chapter&nbsp;27.&nbsp;Component Implementation - Lesson 8 - Startup Time</h1></div></div></div><p>Artur Hefczyc &lt;<a class="link" href="mailto:artur.hefczyc@tigase.net" target="_top">artur.hefczyc@tigase.net</a>&gt;
v2.0, June 2014: Reformatted for AsciiDoc.
:toc:
:numbered:
:website: <a class="link" href="http://tigase.net/" target="_top">http://tigase.net/</a>
:Date: 2011-05-27 22:52</p><p>A startup hook in the Tigase is different from the shutdown hook.</p><p>This is because you cannot really tell when exactly is the startup time. Is it when the application started, is it when configuration is loaded, is it when all objects are initialized. And this might be even different for each component. Therefore, in fact, there is no startup hook in the Tigase in the same sense as the shutdown hook.</p><p>There are a few methods which are called at startup time in the following order:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><span class="strong"><strong>Constructor</strong></span> - there is of course constructor which has no parameters.  However it does not guarantee that this instance of the component will be used at all. The object could be created just to call <code class="literal">getDefaults(&#8230;&#8203;)</code> and may be destroyed afterwards.</li><li class="listitem"><span class="strong"><strong>void setName(String name)</strong></span> - the second call for the component is to set it&#8217;s unique name within the Tigase instance. It still does not mean too much from the component run-time point of view but some components initialise service discovery data at this point.</li><li class="listitem"><span class="strong"><strong>void start()</strong></span> - this is a second which means the component can start it&#8217;s internal jobs or worker threads or whatever it needs for future activity. Component&#8217;s queues and threads are initialised at this point.</li><li class="listitem"><span class="strong"><strong>Map&lt;String, Object&gt; getDefaults(Map params)</strong></span> - this is the next call made by configuration manager to collect all the default settings for the component. To help generate default settings, configuration manager passes general properties (starting with <span class="emphasis"><em>--</em></span>) in the Map as parameter to the component. As a result it expects specific settings applicable to the component only (not starting with <span class="emphasis"><em>--</em></span>).</li><li class="listitem"><span class="strong"><strong>setProperties(Map&lt;String, Object&gt; props)</strong></span> - after collecting component&#8217;s defaults, the connection manager combines them with configuration options (not starting with <span class="emphasis"><em>--</em></span>, but starting with the component name) loaded from configuration repository (init.properties file, database, possibly other files). Then the final configuration is passed to the component with <code class="literal">setProperties(&#8230;&#8203;)</code> method call. Database connections are usually initialised at this point.</li><li class="listitem"><span class="strong"><strong>void initializationCompleted()</strong></span> - this method is called for all components after all components are loaded and configuration was set (via <code class="literal">setProperties(&#8230;&#8203;)</code> method call) for all components.</li></ol></div><p>Therefore, <code class="literal">initializationCompleted()</code> hook is the best point if you want to be sure that the Tigase server is fully loaded, initialised and functional</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="_configuration.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="cil7.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Configuration&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;28.&nbsp;Component Implementation - Lesson 7 - Data Repository</td></tr></table></div></body></html>