<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;15.&nbsp;SASL Custom Mechanisms and Configuration</title><link rel="stylesheet" type="text/css" href="css/docbook-xsl.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"><link rel="home" href="index.html" title="Tigase Development Guide"><link rel="up" href="index.html" title="Tigase Development Guide"><link rel="prev" href="_plugin_development.html" title="Chapter&nbsp;14.&nbsp;Plugin Development"><link rel="next" href="_logging_authentication.html" title="Logging/Authentication"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;15.&nbsp;SASL Custom Mechanisms and Configuration</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="_plugin_development.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="_logging_authentication.html">Next</a></td></tr></table><hr></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="saslcmac"></a>Chapter&nbsp;15.&nbsp;SASL Custom Mechanisms and Configuration</h1></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="section"><a href="saslcmac.html#_basic_sasl_configuration">Basic SASL Configuration</a></span></dt><dd><dl><dt><span class="section"><a href="saslcmac.html#mechconf">Mechanisms Configuration</a></span></dt><dt><span class="section"><a href="saslcmac.html#cbconf">CallbackHandler Configuration</a></span></dt><dt><span class="section"><a href="saslcmac.html#selmech">Selecting Mechanisms Available in the Stream</a></span></dt></dl></dd><dt><span class="section"><a href="_logging_authentication.html">Logging/Authentication</a></span></dt><dd><dl><dt><span class="section"><a href="_logging_authentication.html#_built_in_mechanisms">Built-in Mechanisms</a></span></dt></dl></dd><dt><span class="section"><a href="cmd.html">Custom Mechanisms Development</a></span></dt><dd><dl><dt><span class="section"><a href="cmd.html#__emphasis_role_strong_mechanism_emphasis"><span class="strong"><strong>Mechanism</strong></span></a></span></dt><dt><span class="section"><a href="cmd.html#__emphasis_role_strong_callbackhandler_emphasis"><span class="strong"><strong>CallbackHandler</strong></span></a></span></dt><dt><span class="section"><a href="cmd.html#_general_remarks">General Remarks</a></span></dt><dt><span class="section"><a href="cmd.html#_known_problems">Known Problems</a></span></dt></dl></dd></dl></div><p>Bartosz Malkowski &lt;<a class="link" href="mailto:bmalkowski@tigase.pl" target="_top">bmalkowski@tigase.pl</a>&gt;
v2.0, June 2014: Reformatted for AsciiDoc.
:toc:
:numbered:
:website: <a class="link" href="http://tigase.net/" target="_top">http://tigase.net/</a>
:Date: 2013-01-23 03:54</p><p><span class="strong"><strong>This API is available from Tigase XMPP Server version 5.2.0 or our current master branch.</strong></span></p><p><span class="emphasis"><em>Note that API is under active development. This description may be updated at any time.</em></span></p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="_basic_sasl_configuration"></a>Basic SASL Configuration</h2></div></div></div><p>SASL implementation in the Tigase XMPP Server is compatible with Java API.The same exact interfaces are used.</p><p>The SASL implementation consists of following parts:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">mechanism</li><li class="listitem">CallbackHandler</li></ol></div><p>Properties list for SASL plugin <span class="emphasis"><em>(sess-man/plugins-conf/urn\:ietf\:params\:xml\:ns\:xmpp-sasl):</em></span></p><div class="informaltable"><table border="1" width="90%"><colgroup><col class="col_1"><col class="col_2"></colgroup><tbody><tr><td align="left" valign="top"><p><span class="strong"><strong>Property</strong></span></p></td><td align="left" valign="top"><p><span class="strong"><strong>Description</strong></span></p></td></tr><tr><td align="left" valign="top"><p>factory</p></td><td align="left" valign="top"><p>A factory class for SASL mechanisms. Detailed description at <a class="link" href="saslcmac.html#mechconf" title="Mechanisms Configuration">Mechanisms configuration</a></p></td></tr><tr><td align="left" valign="top"><p>callbackhandler</p></td><td align="left" valign="top"><p>A default callback handler class. Detailed description at <a class="link" href="saslcmac.html#cbconf" title="CallbackHandler Configuration">CallbackHandler configuration</a></p></td></tr><tr><td align="left" valign="top"><p>callbackhandler-${MECHANISM}</p></td><td align="left" valign="top"><p>A callback handler class for a particular mechanism. Detailed description at <a class="link" href="saslcmac.html#cbconf" title="CallbackHandler Configuration">CallbackHandler configuration</a></p></td></tr><tr><td align="left" valign="top"><p>mechanism-selector</p></td><td align="left" valign="top"><p>A class for filtering SASL mechanisms available in a stream. Detailed description at <a class="link" href="saslcmac.html#selmech" title="Selecting Mechanisms Available in the Stream">Selecting mechanisms</a></p></td></tr></tbody></table></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mechconf"></a>Mechanisms Configuration</h3></div></div></div><p>To add a new mechanism, a new factory for the mechanism has to be registered. It can be done with a new line in the <code class="literal">init.properties</code> file like this one:</p><p><code class="literal">sess-man/plugins-conf/urn\:ietf\:params\:xml\:ns\:xmpp-sasl/factory=com.example.OwnFactory</code></p><p>The class must implement <code class="literal">'SaslServerFactory'</code> interface. All mechanisms returned by <code class="literal">'getMechanismNames()'</code> method will be registered automatically.</p><p>The factory which is available and registered by default is <code class="literal">'tigase.auth.TigaseSaslServerFactory'</code> which provides <code class="literal">PLAIN</code> and <code class="literal">ANONYMOUS</code> mechanisms.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="cbconf"></a>CallbackHandler Configuration</h3></div></div></div><p>The <code class="literal">CallbackHandler</code> is a helper class used for loading/retrieving authentication data from data repository and providing them to a mechanism.</p><p>To register a new callback handler a new line in the <code class="literal">init.properties</code> file like this one has to be added:</p><p><code class="literal">sess-man/plugins-conf/urn\:ietf\:params\:xml\:ns\:xmpp-sasl/callbackhandler=com.example.DefaultCallbackHandler</code></p><p>It is also possible to register different callback handlers for different mechanisms:</p><p><code class="literal">sess-man/plugins-conf/urn\:ietf\:params\:xml\:ns\:xmpp-sasl/callbackhandler-PLAIN=com.example.PlainCallbackHandler</code></p><p><code class="literal">sess-man/plugins-conf/urn\:ietf\:params\:xml\:ns\:xmpp-sasl/callbackhandler-OAUTH=com.example.OAuthCallbackHandler</code></p><p>During authentication process, the Tigase server always checks for a handler specific to selected mechanisms, and if there is no specific handler a default one is used.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="selmech"></a>Selecting Mechanisms Available in the Stream</h3></div></div></div><p>Interface <code class="literal">'tigase.auth.MechanismSelector'</code> is used for selecting mechanisms available in a stream. Method <code class="literal">'filterMechanisms()'</code> should return a collection with mechanisms available based on:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">all registered SASL factories</li><li class="listitem">XMPP session data (from <code class="literal">'XMPPResourceConnection'</code> class)</li></ol></div><p>The default selector returns mechanisms from the default Tigase&#8217;s factory <code class="literal">('TigaseSaslServerFactory')</code> only.</p><p>It is possible to use a custom selector by specifying it&#8217;s class int the <code class="literal">init.properties</code> file:</p><p><code class="literal">sess-man/plugins-conf/urn\:ietf\:params\:xml\:ns\:xmpp-sasl/mechanism-selector=com.example.OwnSelector</code></p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="_plugin_development.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="_logging_authentication.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;14.&nbsp;Plugin Development&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Logging/Authentication</td></tr></table></div></body></html>